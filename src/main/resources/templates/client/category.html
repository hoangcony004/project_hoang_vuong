<main class="main">
	<div class="page-header text-center" style="background-image: url('/client/assets/images/page-header-bg.jpg')">
		<div class="container">
			<h1 class="page-title">Sản Phẩm<span>Shop</span></h1>
		</div><!-- End .container -->
	</div><!-- End .page-header -->
	<nav aria-label="breadcrumb" class="breadcrumb-nav mb-2">
		<div class="container">
			<ol class="breadcrumb">
				<li class="breadcrumb-item"><a href="/">Home</a></li>
				<li class="breadcrumb-item active" aria-current="page">Sản Phẩm</li>
			</ol>
		</div><!-- End .container -->
	</nav><!-- End .breadcrumb-nav -->

	<div class="page-content">
		<div class="container">
			<div class="row">
				<div class="col-lg-9">
					<div class="toolbox">
						<div class="toolbox-left">

						</div><!-- End .toolbox-left -->

						<div class="toolbox-right">
							<div class="toolbox-sort">
								<label for="sortby">Trạng Thái:</label>
								<div class="select-custom">
									<select name="sortby" id="sortby" class="form-control">
										<option value="popularity" selected="selected">bán chạy</option>
										<option value="rating">nổi bật</option>
									</select>
								</div>
							</div><!-- End .toolbox-sort -->
							<div class="toolbox-layout">



								<a href="category.html" class="btn-layout active">
									<svg width="16" height="10">
										<rect x="0" y="0" width="4" height="4" />
										<rect x="6" y="0" width="4" height="4" />
										<rect x="12" y="0" width="4" height="4" />
										<rect x="0" y="6" width="4" height="4" />
										<rect x="6" y="6" width="4" height="4" />
										<rect x="12" y="6" width="4" height="4" />
									</svg>
								</a>

							</div><!-- End .toolbox-layout -->
						</div><!-- End .toolbox-right -->
					</div><!-- End .toolbox -->

					<div class="products mb-3">
						<div class="row justify-content-center">
							<div class="col-6 col-md-4 col-lg-4" th:each="dl:${dlns}">
								<div class="product product-7 text-center">
									<figure class="product-media">
										<span class="product-label label-new">New</span>
										<a th:href="@{/apps/product(id=${dl.id})}" style="background-color: white;">
											<img th:src="${dl.anhDaiDien}" alt="Product image" class="product-image">

										</a>
										<style>
											.product-image {
												width: 100%;
												/* Chiều rộng ảnh theo 100% của phần tử cha */
												max-width: 200px;
												/* Kích thước tối đa để tránh ảnh quá lớn */
												height: auto;
												/* Đảm bảo chiều cao tự động theo tỉ lệ ảnh */
												object-fit: cover;
												/* Đảm bảo ảnh không bị méo, cắt ảnh để vừa kích thước */
											}
										</style>

										<div class="product-action-vertical">
											<a href="#" class="btn-product-icon btn-wishlist btn-expandable"><span>add
													to wishlist</span></a>
										</div><!-- End .product-action-vertical -->

										<div class="product-action">
											<a th:onclick="cart.add([[${dl.id}]], 1, [[${dl.tenSP}]])"
												class="btn-product btn-cart"><span>add to cart</span></a>
										</div><!-- End .product-action -->
									</figure><!-- End .product-media -->

									<div class="product-body">
										<div class="product-cat">
											<!-- <p th:text="${dl.model}"></p> -->
										</div><!-- End .product-cat -->
										<h3 class="product-title">
											<h6 th:text="${dl.tenSP}"></h6>
										</h3><!-- End .product-title -->
										<div class="product-price">
											<p th:text="${dl.getFomatGiaBan}"></p>
										</div><!-- End .product-price -->
										<!-- <div class="ratings-container">
											<div class="ratings">
												<div class="ratings-val" style="width: 80%;"></div>
											</div>
											<span class="ratings-text">( 2 Reviews )</span>
										</div> -->

										<div class="product-nav product-nav-thumbs">
											<a class="active" th:each="anh : ${dl.anhSanPham}">
												<img th:src="${anh.hinhAnh}" alt="product desc">
											</a>

										</div><!-- End .product-nav -->
									</div><!-- End .product-body -->
								</div><!-- End .product -->
							</div><!-- End .col-sm-6 col-lg-4 -->

						</div><!-- End .row -->
					</div><!-- End .products -->

					<nav class="pagination-container">
						<ul class="pagination justify-content-center">
							<!-- Trang đầu -->
							<li class="page-item" th:classappend="${currentPage == 1} ? 'disabled' : ''">
								<a class="page-link"
									th:href="@{'/apps/categories?id=' + (${id} != null ? ${id} : 0) + '&page=1&pageSize=' + ${pageSize}}">Đầu</a>
							</li>

							<!-- Trang trước -->
							<li class="page-item" th:classappend="${currentPage == 1} ? 'disabled' : ''">
								<a class="page-link"
									th:href="@{'/apps/categories?id=' + (${id} != null ? ${id} : 0) + '&page=' + (${currentPage > 1 ? currentPage - 1 : 1}) + '&pageSize=' + ${pageSize}}">
									<i class="fas fa-chevron-left"></i>

								</a>
							</li>

							<!-- Trang đầu tiên -->
							<li class="page-item" th:classappend="${currentPage == 1} ? 'active' : ''">
								<a class="page-link"
									th:href="@{'/apps/categories?id=' + (${id} != null ? ${id} : 0) + '&page=1&pageSize=' + ${pageSize}}">1</a>
							</li>

							<!-- Hiển thị "..." nếu cần và tổng số trang lớn hơn 2 -->
							<li class="page-item" th:if="${totalPages > 2} and ${currentPage > 4}">
								<span class="page-link">...</span>
							</li>

							<!-- Các trang giữa -->
							<li class="page-item"
								th:each="i : ${#numbers.sequence(currentPage > 3 ? currentPage - 1 : 2, currentPage < totalPages - 2 ? currentPage + 1 : totalPages - 1)}"
								th:classappend="${currentPage == i} ? 'active' : ''" th:if="${totalPages > 2}">
								<a class="page-link"
									th:href="@{'/apps/categories?id=' + (${id} != null ? ${id} : 0) + '&page=' + ${i} + '&pageSize=' + ${pageSize}}">[[${i}]]</a>
							</li>

							<!-- Hiển thị "..." nếu cần và tổng số trang lớn hơn 2 -->
							<li class="page-item" th:if="${totalPages > 2} and ${currentPage < totalPages - 3}">
								<span class="page-link">...</span>
							</li>

							<!-- Trang cuối -->
							<li class="page-item" th:classappend="${currentPage == totalPages} ? 'active' : ''"
								th:if="${totalPages > 1}">
								<a class="page-link"
									th:href="@{'/apps/categories?id=' + (${id} != null ? ${id} : 0) + '&page=' + ${totalPages} + '&pageSize=' + ${pageSize}}">[[${totalPages}]]</a>
							</li>

							<!-- Trang tiếp theo -->
							<li class="page-item" th:classappend="${currentPage >= totalPages} ? 'disabled' : ''">
								<a class="page-link"
									th:href="@{'/apps/categories?id=' + (${id} != null ? ${id} : 0) + '&page=' + (${currentPage < totalPages ? currentPage + 1 : totalPages}) + '&pageSize=' + ${pageSize}}">
									<i class="fas fa-chevron-right"></i>
								</a>
							</li>

							<!-- Trang cuối -->
							<li class="page-item" th:classappend="${currentPage >= totalPages} ? 'disabled' : ''">
								<a class="page-link"
									th:href="@{'/apps/categories?id=' + (${id} != null ? ${id} : 0) + '&page=' + ${totalPages} + '&pageSize=' + ${pageSize}}">Cuối</a>
							</li>
						</ul>
					</nav>

				</div><!-- End .col-lg-9 -->
				<aside class="col-lg-3 order-lg-first">
					<div class="sidebar sidebar-shop">
						<form action="/apps/categories" method="post">
							<div class="widget widget-clean">
								<label>Filters:</label>
								<button type="submit">Lọc thông tin</button>
							</div><!-- End .widget widget-clean -->

							<div class="widget widget-collapsible">
								<h3 class="widget-title">
									<a data-toggle="collapse" href="#widget-1" role="button" aria-expanded="true"
										aria-controls="widget-1">
										Nhà Sản Xuất
									</a>
								</h3><!-- End .widget-title -->


								<div class="collapse show" id="widget-1">
									<div class="widget-body">
										<div class="filter-items filter-items-count">
											<div class="filter-item" th:each="dl : ${dlnsx}">
												<div class="custom-control custom-checkbox">
													<input type="radio" class="custom-control-input" name="category"
														th:value="${dl.id}" th:id="'cat-'+${dl.id}">
													<label class="custom-control-label" th:for="'cat-'+${dl.id}"
														th:text="${dl.ten}"></label>
												</div><!-- End .custom-checkbox -->
												<span class="item-count"></span>
											</div><!-- End .filter-item -->
										</div><!-- End .filter-items -->
									</div><!-- End .widget-body -->
								</div><!-- End .collapse -->
							</div><!-- End .widget -->

							<div class="widget widget-collapsible">
								<h3 class="widget-title">
									<a data-toggle="collapse" href="#widget-5" role="button" aria-expanded="true"
										aria-controls="widget-5">
										Giá
									</a>
								</h3><!-- End .widget-title -->

								<div class="collapse show" id="widget-5">
									<div class="widget-body">
										<div class="filter-price">
											<div class="row mb-3">
												<h6>Chọn khoảng giá</h6>
												<div class="slider-container">
													<!-- Nhãn cho thanh trượt giá thấp nhất -->
													<label for="minRange">Giá thấp nhất</label>
													<input type="range" id="minRange" name="minPrice" min="500000"
														max="1000000" value="500000" step="10" class="custom-range">
													<span class="slider-value min" id="minValue">500.000</span>
													<br>
													<!-- Nhãn cho thanh trượt giá cao nhất -->
													<label for="maxRange">Giá cao nhất</label>
													<input type="range" id="maxRange" name="maxPrice" min="2000000"
														max="50000000" value="25000000" step="10" class="custom-range">
													<span class="slider-value max" id="maxValue">5.000.000</span>
												</div>
												<p>Khoảng giá: <span id="priceRange">500.000 - 5.000.000</span></p>
											</div>
											<!-- Vùng hiển thị kết quả sản phẩm sau khi lọc -->
											<div id="sanPhamResults"></div>

										</div><!-- End .filter-price -->
									</div><!-- End .widget-body -->
								</div><!-- End .collapse -->
							</div><!-- End .widget -->
						</form>
					</div><!-- End .sidebar sidebar-shop -->
				</aside><!-- End .col-lg-3 -->
			</div><!-- End .row -->
		</div><!-- End .container -->
	</div><!-- End .page-content -->
</main><!-- End .main -->

<script>
	document.addEventListener('DOMContentLoaded', function () {
		const minRange = document.getElementById('minRange');
		const maxRange = document.getElementById('maxRange');
		const minValue = document.getElementById('minValue');
		const maxValue = document.getElementById('maxValue');
		const priceRange = document.getElementById('priceRange');

		// Hàm để định dạng số thành dạng tiền tệ
		function formatCurrency(value) {
			return new Intl.NumberFormat('vi-VN').format(value);
		}

		// Cập nhật giá trị ban đầu
		minValue.textContent = formatCurrency(minRange.value);
		maxValue.textContent = formatCurrency(maxRange.value);
		priceRange.textContent = `${formatCurrency(minRange.value)} - ${formatCurrency(maxRange.value)}`;

		// Lắng nghe sự kiện thay đổi trên thanh trượt minRange
		minRange.addEventListener('input', function () {
			minValue.textContent = formatCurrency(minRange.value);
			priceRange.textContent = `${formatCurrency(minRange.value)} - ${formatCurrency(maxRange.value)}`;
		});

		// Lắng nghe sự kiện thay đổi trên thanh trượt maxRange
		maxRange.addEventListener('input', function () {
			maxValue.textContent = formatCurrency(maxRange.value);
			priceRange.textContent = `${formatCurrency(minRange.value)} - ${formatCurrency(maxRange.value)}`;
		});
	});


</script>